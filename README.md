# Парсер производственного календаря Consultant.ru

Этот Python-скрипт автоматически собирает информацию о выходных и предпраздничных днях за указанный год с сайта Consultant.ru и сохраняет её в структурированный JSON-файл.

## Особенности реализации

Скрипт использует нестандартный подход к парсингу, работая с сырым HTML-кодом как с текстом, а не через традиционный анализ DOM-дерева. Это делает его логику уникальной и эффективной для данной конкретной задачи.

## Логика работы кода

1.  **Получение и валидация года:**
    *   Предлагается ввод года с текущим годом по умолчанию.
    *   Реализована проверка на корректность ввода (целое число).
    *   Если поле ввода пустое, автоматически подставляется текущий год.

2.  **Динамический запрос и обработка ошибок:**
    *   URL формируется динамически на основе введенного года.
    *   Реализован цикл с проверкой статус-кода ответа (200 = OK).
    *   При получении ошибки (например, 404 для будущих лет) скрипт запрашивает корректный год до тех пор, пока не будет получена валидная страница.

3.  **Уникальный алгоритм парсинга:**
    *   **Разбивка на строки:** HTML-код ответа разбивается на отдельные строки.
    *   **Первичная фильтрация:** Отбираются только строки, которые:
        *   Содержат ключевые слова `'weekend'` или `'preholiday'`.
        *   При этом содержат хотя бы одну цифру (чтобы отфильтровать строки с только CSS-классами).
    *   **Извлечение данных:** Отфильтрованные строки обрабатываются путем:
        *   Разделения по подстроке `'class="'`.
        *   Анализа начала каждого полученного сегмента.
        *   Поиска в сегменте подстрок, начинающихся на `'weekend'`, `'holiday weekend'` или `'preholiday'`.
        *   Извлечения числа (дня месяца) из этих сегментов с помощью фильтрации цифр.

4.  **Структурирование данных:**
    *   Данные первоначально сохраняются в словари `holidays` и `preholidays`, где ключи - это номера месяцев (0-11), а значения - списки чисел (дней в этом месяце).
    *   Индекс строки в отфильтрованном списке (`line`) соответствует номеру месяца.

5.  **Форматирование и экспорт:**
    *   Числа (дни) объединяются с годом и месяцем в объекты `datetime`.
    *   Даты форматируются в стандартный строковый вид `ГГГГ-ММ-ДД`.
    *   Результат сохраняется в JSON-файл с понятной структурой и отступами для читаемости.

## Структура выходного JSON-файла

Результат работы скрипта - файл `result_{year}.json` со следующей структурой:

```json
{
  "holidays": [
    "2024-01-01",
    "2024-01-02",
    "2024-01-03",
    ...
  ],
  "preholidays": [
    "2024-02-22",
    "2024-03-07",
    "2024-11-01",
    ...
  ]
}
